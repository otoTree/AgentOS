<svg width="1100" height="1300" xmlns="http://www.w3.org/2000/svg" font-family="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif">
  <!-- Background -->
  <rect width="100%" height="100%" fill="#ffffff" />

  <!-- Definitions for Markers -->
  <defs>
    <!-- Standard Arrowhead -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
    </marker>
    <!-- Standard Arrowstart -->
    <marker id="arrowstart" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="10 0, 0 3.5, 10 7" fill="#64748b" />
    </marker>
    <!-- Blue Arrowhead for AgentRT connections -->
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0ea5e9" />
    </marker>
    <!-- Blue Arrowstart for AgentRT connections -->
    <marker id="arrowstart-blue" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="10 0, 0 3.5, 10 7" fill="#0ea5e9" />
    </marker>
    <!-- Green Arrowhead for MCP connections -->
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#10b981" />
    </marker>
    <marker id="arrowstart-green" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="10 0, 0 3.5, 10 7" fill="#10b981" />
    </marker>
  </defs>

  <!-- ========================================== -->
  <!-- 1. Cluster Layer (Top) -->
  <!-- ========================================== -->
  <!-- Group Background -->
  <rect x="50" y="50" width="1000" height="240" rx="10" fill="#f8fafc" stroke="#e2e8f0" stroke-width="2" />
  <text x="70" y="80" font-size="18" font-weight="bold" fill="#475569">Cluster Layer (K3s Mesh)</text>

  <!-- Node: K3s (Left) -->
  <rect x="100" y="100" width="260" height="150" rx="6" fill="#ffffff" stroke="#94a3b8" stroke-width="1.5" />
  <text x="230" y="125" font-size="15" font-weight="bold" text-anchor="middle" fill="#1e293b">K3s Runtime</text>
  <line x1="110" y1="135" x2="350" y2="135" stroke="#cbd5e1" stroke-width="1" />
  <text x="120" y="160" font-size="13" fill="#334155">• Control Plane / Worker</text>
  <text x="120" y="185" font-size="13" fill="#334155">• Containerd (No Docker)</text>
  <text x="120" y="210" font-size="13" fill="#334155">• Pod Lifecycle</text>

  <!-- Node: Disco (Middle) -->
  <rect x="420" y="100" width="260" height="150" rx="6" fill="#ffffff" stroke="#94a3b8" stroke-width="1.5" />
  <text x="550" y="125" font-size="15" font-weight="bold" text-anchor="middle" fill="#1e293b">Swarm Discovery</text>
  <line x1="430" y1="135" x2="670" y2="135" stroke="#cbd5e1" stroke-width="1" />
  <text x="440" y="160" font-size="13" fill="#334155">• Avahi (mDNS)</text>
  <text x="440" y="185" font-size="13" fill="#334155">• Gossip Protocol</text>
  <text x="440" y="210" font-size="13" fill="#334155">• Capability Broadcast</text>

  <!-- Node: Sched (Right) -->
  <rect x="740" y="100" width="260" height="150" rx="6" fill="#ffffff" stroke="#94a3b8" stroke-width="1.5" />
  <text x="870" y="125" font-size="15" font-weight="bold" text-anchor="middle" fill="#1e293b">Orchestration</text>
  <line x1="750" y1="135" x2="990" y2="135" stroke="#cbd5e1" stroke-width="1" />
  <text x="760" y="160" font-size="13" fill="#334155">• Task Scheduler</text>
  <text x="760" y="185" font-size="13" fill="#334155">• Load Balancer</text>
  <text x="760" y="210" font-size="13" fill="#334155">• Skill Distribution</text>

  <!-- Link: K3s <-> Disco -->
  <line x1="360" y1="175" x2="420" y2="175" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)" marker-start="url(#arrowstart)" />
  <!-- Link: Disco <-> Sched -->
  <line x1="680" y1="175" x2="740" y2="175" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)" marker-start="url(#arrowstart)" />


  <!-- ========================================== -->
  <!-- 2. OS User Space (Middle) -->
  <!-- ========================================== -->
  <!-- Group Background -->
  <rect x="50" y="320" width="1000" height="650" rx="10" fill="#f0f9ff" stroke="#bae6fd" stroke-width="2" />
  <text x="70" y="350" font-size="18" font-weight="bold" fill="#0369a1">OS User Space</text>

  <!-- Node: Native UI (Top Left) -->
  <rect x="100" y="380" width="220" height="130" rx="6" fill="#ffffff" stroke="#7dd3fc" stroke-width="1.5" />
  <text x="210" y="405" font-size="15" font-weight="bold" text-anchor="middle" fill="#1e293b">Native UI Engine</text>
  <line x1="110" y1="415" x2="310" y2="415" stroke="#e0f2fe" stroke-width="1" />
  <text x="120" y="440" font-size="13" fill="#334155">• Flutter (Skia/Impeller)</text>
  <text x="120" y="465" font-size="13" fill="#334155">• State Tree Projection</text>
  <text x="120" y="490" font-size="12" fill="#64748b" font-style="italic">(No X11/Wayland)</text>

  <!-- Node: Terminal (Top Right) -->
  <rect x="780" y="380" width="220" height="130" rx="6" fill="#ffffff" stroke="#7dd3fc" stroke-width="1.5" />
  <text x="890" y="405" font-size="15" font-weight="bold" text-anchor="middle" fill="#1e293b">Human Access</text>
  <line x1="790" y1="415" x2="990" y2="415" stroke="#e0f2fe" stroke-width="1" />
  <text x="800" y="440" font-size="13" fill="#334155">• SSH / WebTTY</text>
  <text x="800" y="465" font-size="13" fill="#334155">• Kiosk Overlay</text>
  <text x="800" y="490" font-size="13" fill="#334155">• Kill Switch</text>

  <!-- Node: AgentRT (Center) - Highlighted -->
  <rect x="400" y="500" width="300" height="220" rx="8" fill="#ffffff" stroke="#0ea5e9" stroke-width="3" />
  <text x="550" y="530" font-size="16" font-weight="bold" text-anchor="middle" fill="#0f172a">AgentOS Runtime</text>
  <text x="550" y="550" font-size="12" text-anchor="middle" fill="#64748b">(Root Service)</text>
  <line x1="410" y1="560" x2="690" y2="560" stroke="#e0f2fe" stroke-width="2" />
  
  <text x="420" y="590" font-size="13" fill="#0f172a">• AUP Protocol (JSON-RPC)</text>
  <text x="420" y="615" font-size="13" fill="#0f172a">• Task Slicer (DAG Planner)</text>
  <text x="420" y="640" font-size="13" fill="#0f172a">• Process Manager</text>
  <text x="420" y="665" font-size="13" fill="#0f172a">• Context Memory</text>
  <text x="420" y="690" font-size="13" fill="#0f172a">• Security Monitor</text>

  <!-- Node: MCP Capability System (Right of AgentRT) -->
  <rect x="780" y="540" width="240" height="220" rx="8" fill="#ecfdf5" stroke="#34d399" stroke-width="2" />
  <text x="900" y="565" font-size="15" font-weight="bold" text-anchor="middle" fill="#065f46">MCP Capability System</text>
  <line x1="790" y1="575" x2="1010" y2="575" stroke="#a7f3d0" stroke-width="1" />
  
  <!-- Sub-node: Skills -->
  <rect x="800" y="590" width="200" height="60" rx="4" fill="#ffffff" stroke="#34d399" stroke-width="1" />
  <text x="810" y="610" font-size="13" font-weight="bold" fill="#065f46">Skills (Local)</text>
  <text x="810" y="630" font-size="12" fill="#047857">• WasmEdge Sandbox</text>
  <text x="810" y="645" font-size="12" fill="#047857">• Python Scripts (MCP Tool)</text>
  
  <!-- Sub-node: Plugins -->
  <rect x="800" y="660" width="200" height="60" rx="4" fill="#ffffff" stroke="#34d399" stroke-width="1" />
  <text x="810" y="680" font-size="13" font-weight="bold" fill="#065f46">Plugins (Remote)</text>
  <text x="810" y="700" font-size="12" fill="#047857">• Ext. API (Weather, etc)</text>
  <text x="810" y="715" font-size="12" fill="#047857">• MCP Resources</text>

  <!-- Node: Inference (Bottom Left) -->
  <rect x="100" y="780" width="220" height="130" rx="6" fill="#ffffff" stroke="#7dd3fc" stroke-width="1.5" />
  <text x="210" y="805" font-size="15" font-weight="bold" text-anchor="middle" fill="#1e293b">Inference Engine</text>
  <line x1="110" y1="815" x2="310" y2="815" stroke="#e0f2fe" stroke-width="1" />
  <text x="120" y="840" font-size="13" fill="#334155">• BPU Runtime</text>
  <text x="120" y="865" font-size="13" fill="#334155">• Hobot DNN / ONNX</text>
  <text x="120" y="890" font-size="13" fill="#334155">• Local LLM</text>

  <!-- Node: HAL (Bottom Right-ish) -->
  <rect x="440" y="780" width="220" height="130" rx="6" fill="#ffffff" stroke="#7dd3fc" stroke-width="1.5" />
  <text x="550" y="805" font-size="15" font-weight="bold" text-anchor="middle" fill="#1e293b">Hardware HAL</text>
  <line x1="450" y1="815" x2="650" y2="815" stroke="#e0f2fe" stroke-width="1" />
  <text x="460" y="840" font-size="13" fill="#334155">• GPIO / I2C / UART</text>
  <text x="460" y="865" font-size="13" fill="#334155">• Camera / Audio</text>
  <text x="460" y="890" font-size="13" fill="#334155">• Network Manager</text>

  <!-- ========================================== -->
  <!-- 3. Kernel Space (Bottom) -->
  <!-- ========================================== -->
  <!-- Group Background -->
  <rect x="50" y="1000" width="1000" height="200" rx="10" fill="#fdf4ff" stroke="#f0abfc" stroke-width="2" />
  <text x="70" y="1030" font-size="18" font-weight="bold" fill="#86198f">Kernel Space</text>

  <!-- Node: Linux (Left) -->
  <rect x="100" y="1060" width="260" height="110" rx="6" fill="#ffffff" stroke="#d8b4fe" stroke-width="1.5" />
  <text x="230" y="1085" font-size="15" font-weight="bold" text-anchor="middle" fill="#4c1d95">Linux Kernel</text>
  <line x1="110" y1="1095" x2="350" y2="1095" stroke="#e9d5ff" stroke-width="1" />
  <text x="120" y="1120" font-size="13" fill="#4c1d95">• Version 5.10+ (LTS)</text>
  <text x="120" y="1145" font-size="13" fill="#4c1d95">• Seccomp / AppArmor</text>

  <!-- Node: Drivers (Middle) -->
  <rect x="420" y="1060" width="260" height="110" rx="6" fill="#ffffff" stroke="#d8b4fe" stroke-width="1.5" />
  <text x="550" y="1085" font-size="15" font-weight="bold" text-anchor="middle" fill="#4c1d95">Hardware Drivers</text>
  <line x1="430" y1="1095" x2="670" y2="1095" stroke="#e9d5ff" stroke-width="1" />
  <text x="440" y="1120" font-size="13" fill="#4c1d95">• BPU / VPU / ISP</text>
  <text x="440" y="1145" font-size="13" fill="#4c1d95">• V4L2 Devices</text>

  <!-- Node: DRM (Right) -->
  <rect x="740" y="1060" width="260" height="110" rx="6" fill="#ffffff" stroke="#d8b4fe" stroke-width="1.5" />
  <text x="870" y="1085" font-size="15" font-weight="bold" text-anchor="middle" fill="#4c1d95">Graphics Stack</text>
  <line x1="750" y1="1095" x2="990" y2="1095" stroke="#e9d5ff" stroke-width="1" />
  <text x="760" y="1120" font-size="13" fill="#4c1d95">• DRM / KMS</text>
  <text x="760" y="1145" font-size="13" fill="#4c1d95">• Zero-Copy Rendering</text>

  <!-- ========================================== -->
  <!-- CONNECTIONS -->
  <!-- ========================================== -->
  
  <!-- AgentRT <-> MCP System -->
  <line x1="700" y1="650" x2="780" y2="650" stroke="#10b981" stroke-width="2.5" marker-end="url(#arrowhead-green)" marker-start="url(#arrowstart-green)" />
  <text x="720" y="640" font-size="12" fill="#059669" font-weight="bold">MCP Protocol</text>

  <!-- AgentRT <-> UI -->
  <line x1="400" y1="530" x2="320" y2="480" stroke="#0ea5e9" stroke-width="2" marker-end="url(#arrowhead-blue)" marker-start="url(#arrowstart-blue)" stroke-dasharray="4" />

  <!-- AgentRT <-> Terminal -->
  <line x1="700" y1="530" x2="780" y2="480" stroke="#0ea5e9" stroke-width="2" marker-end="url(#arrowhead-blue)" marker-start="url(#arrowstart-blue)" stroke-dasharray="4" />

  <!-- AgentRT <-> Inf -->
  <line x1="400" y1="690" x2="320" y2="780" stroke="#0ea5e9" stroke-width="2" marker-end="url(#arrowhead-blue)" marker-start="url(#arrowstart-blue)" />

  <!-- AgentRT <-> HAL -->
  <line x1="550" y1="720" x2="550" y2="780" stroke="#0ea5e9" stroke-width="2" marker-end="url(#arrowhead-blue)" marker-start="url(#arrowstart-blue)" />

  <!-- AgentRT <-> K3s (Upward) -->
  <path d="M 550 500 L 550 280 L 250 280 L 250 250" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrowhead)" marker-start="url(#arrowstart)" stroke-dasharray="5,5" />
  <text x="280" y="300" font-size="12" fill="#64748b">Pod Scheduling</text>

  <!-- MCP <-> K3s (Upward) -->
  <!-- Indicates skills can also be pods -->
  <path d="M 900 540 L 900 280 L 800 280 L 800 250" stroke="#34d399" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="3,3" />
  <text x="820" y="300" font-size="12" fill="#059669">Skill Pods</text>

  <!-- Inf <-> Drivers (Downward) -->
  <path d="M 210 910 L 210 960 L 550 960 L 550 1060" stroke="#d8b4fe" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="3,3" />
  <text x="350" y="950" font-size="12" fill="#86198f" text-anchor="middle">Direct Hardware Access</text>

</svg>